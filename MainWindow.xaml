<Window x:Class="Multi_Layer_Spoofing_Detector.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:lvc="clr-namespace:LiveCharts.Wpf;assembly=LiveCharts.Wpf"
        Title="AI-Based Multi-Layer Spoofing Detection and Prevention System"
        Height="900" Width="1440"
        MinHeight="720" MinWidth="1024"
        WindowStartupLocation="CenterScreen"
        WindowStyle="None"
        AllowsTransparency="True"
        ResizeMode="CanResize"
        UseLayoutRounding="True"
        SnapsToDevicePixels="True"
        TextOptions.TextFormattingMode="Display"
        TextOptions.TextRenderingMode="ClearType"
        Background="Transparent">

    <Window.Resources>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
             DESIGN SYSTEM â€” ALL COLORS ARE SEMANTIC
             Each color has one meaning; documented in LegendBar
             â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->

        <!-- Base surfaces -->
        <SolidColorBrush x:Key="BgBase"         Color="#F7FAFF"/>
        <SolidColorBrush x:Key="BgPanel"        Color="#EEF4FB"/>
        <SolidColorBrush x:Key="BgCard"         Color="#FFFFFF"/>
        <SolidColorBrush x:Key="BgCardSoft"     Color="#F2F7FE"/>
        <SolidColorBrush x:Key="BorderNormal"   Color="#C9D9EC"/>
        <SolidColorBrush x:Key="BorderBright"   Color="#8BB1DA"/>

        <!-- â”€â”€â”€ SEMANTIC STATUS COLORS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
             SAFE  (#0ED98D) = No threat / nominal state
             WARN  (#F5A623) = Suspicious / medium risk
             CRIT  (#F04058) = Confirmed threat / critical
             INFO  (#3B82F6) = Neutral info / primary action
             â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <SolidColorBrush x:Key="SafeBrush"      Color="#0ED98D"/>
        <SolidColorBrush x:Key="WarnBrush"      Color="#F5A623"/>
        <SolidColorBrush x:Key="CritBrush"      Color="#F04058"/>
        <SolidColorBrush x:Key="InfoBrush"      Color="#3B82F6"/>
        <SolidColorBrush x:Key="AccentBrush"    Color="#06CFEE"/>

        <!-- â”€â”€â”€ PROTOCOL-LAYER COLORS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
             ARP (#A78BFA) = Layer-2 address resolution
             DNS (#22D3EE) = Layer-7 name resolution
             IP  (#60A5FA) = Layer-3 network addressing
             â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <SolidColorBrush x:Key="ArpBrush"       Color="#A78BFA"/>
        <SolidColorBrush x:Key="DnsBrush"       Color="#22D3EE"/>
        <SolidColorBrush x:Key="IpBrush"        Color="#60A5FA"/>

        <!-- Typography -->
        <SolidColorBrush x:Key="TextPrimary"    Color="#102A43"/>
        <SolidColorBrush x:Key="TextSecondary"  Color="#2E4964"/>
        <SolidColorBrush x:Key="TextMuted"      Color="#4E6782"/>
        <SolidColorBrush x:Key="Blacked"        Color="#FF000000"/>
        <SolidColorBrush x:Key="DarkGreen"      Color="DarkGreen"/>

        <!-- Compatibility aliases for code-behind resource keys -->
        <SolidColorBrush x:Key="CriticalBrush"      Color="#F04058"/>
        <SolidColorBrush x:Key="WarningBrush"       Color="#F5A623"/>
        <SolidColorBrush x:Key="PrimaryAccentBrush" Color="#06CFEE"/>
        <SolidColorBrush x:Key="ProtocolArpBrush"   Color="#A78BFA"/>
        <SolidColorBrush x:Key="ProtocolDnsBrush"   Color="#22D3EE"/>
        <SolidColorBrush x:Key="ProtocolIpBrush"    Color="#60A5FA"/>
        <SolidColorBrush x:Key="TextBrush"          Color="#D8EAF8"/>
        <SolidColorBrush x:Key="SubTextBrush"       Color="#6B9EC8"/>

        <!-- Background gradients -->
        <LinearGradientBrush x:Key="AppGradient" StartPoint="0,0" EndPoint="1,1">
            <GradientStop Color="#F7FBFF" Offset="0"/>
            <GradientStop Color="#EDF4FB" Offset="0.5"/>
            <GradientStop Color="#E5EEF8" Offset="1"/>
        </LinearGradientBrush>

        <LinearGradientBrush x:Key="TitleBarGradient" StartPoint="0,0" EndPoint="1,0">
            <GradientStop Color="#E6EFF9" Offset="0"/>
            <GradientStop Color="#DAE8F6" Offset="1"/>
        </LinearGradientBrush>

        <!-- KPI card accent gradients -->
        <LinearGradientBrush x:Key="SafeGradient"  StartPoint="0,0" EndPoint="0,1">
            <GradientStop Color="#0ED98D" Offset="0"/>
            <GradientStop Color="#00A86B" Offset="1"/>
        </LinearGradientBrush>
        <LinearGradientBrush x:Key="WarnGradient"  StartPoint="0,0" EndPoint="0,1">
            <GradientStop Color="#F5A623" Offset="0"/>
            <GradientStop Color="#D4891A" Offset="1"/>
        </LinearGradientBrush>
        <LinearGradientBrush x:Key="CritGradient"  StartPoint="0,0" EndPoint="0,1">
            <GradientStop Color="#F04058" Offset="0"/>
            <GradientStop Color="#C02040" Offset="1"/>
        </LinearGradientBrush>
        <LinearGradientBrush x:Key="InfoGradient"  StartPoint="0,0" EndPoint="0,1">
            <GradientStop Color="#3B82F6" Offset="0"/>
            <GradientStop Color="#1D5FD4" Offset="1"/>
        </LinearGradientBrush>

        <!-- â”€â”€â”€ CARD STYLE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <Style x:Key="CardStyle" TargetType="Border">
            <Setter Property="Background"       Value="{StaticResource BgCard}"/>
            <Setter Property="BorderBrush"      Value="{StaticResource BorderNormal}"/>
            <Setter Property="BorderThickness"  Value="1"/>
            <Setter Property="CornerRadius"     Value="14"/>
            <Setter Property="Padding"          Value="18"/>
            <Setter Property="Margin"           Value="0,0,0,12"/>
        </Style>

        <!-- â”€â”€â”€ TYPOGRAPHY STYLES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <Style x:Key="TitleStyle" TargetType="TextBlock">
            <Setter Property="Foreground"   Value="{StaticResource TextPrimary}"/>
            <Setter Property="FontFamily"   Value="Segoe UI"/>
            <Setter Property="FontSize"     Value="15"/>
            <Setter Property="FontWeight"   Value="SemiBold"/>
        </Style>

        <Style x:Key="SubTitleStyle" TargetType="TextBlock">
            <Setter Property="Foreground"   Value="{StaticResource TextSecondary}"/>
            <Setter Property="FontFamily"   Value="Segoe UI"/>
            <Setter Property="FontSize"     Value="12"/>
            <Setter Property="TextWrapping" Value="Wrap"/>
            <Setter Property="Margin"       Value="0,4,0,12"/>
        </Style>

        <Style x:Key="BodyStyle" TargetType="TextBlock">
            <Setter Property="Foreground"   Value="{StaticResource TextPrimary}"/>
            <Setter Property="FontFamily"   Value="Segoe UI"/>
            <Setter Property="FontSize"     Value="13"/>
            <Setter Property="TextWrapping" Value="Wrap"/>
        </Style>

        <!-- Compatibility text styles referenced by code-behind -->
        <Style x:Key="RegularTextStyle" TargetType="TextBlock" BasedOn="{StaticResource BodyStyle}"/>
        <Style x:Key="SubTextStyle" TargetType="TextBlock" BasedOn="{StaticResource SubTitleStyle}"/>

        <Style x:Key="MonoStyle" TargetType="TextBlock">
            <Setter Property="Foreground"   Value="{StaticResource TextPrimary}"/>
            <Setter Property="FontFamily"   Value="Consolas"/>
            <Setter Property="FontSize"     Value="12"/>
        </Style>

        <Style x:Key="KpiValueStyle" TargetType="TextBlock">
            <Setter Property="Foreground"   Value="{StaticResource TextPrimary}"/>
            <Setter Property="FontFamily"   Value="Segoe UI"/>
            <Setter Property="FontSize"     Value="34"/>
            <Setter Property="FontWeight"   Value="Bold"/>
            <Setter Property="LineHeight"   Value="38"/>
        </Style>

        <!-- â”€â”€â”€ STEP BADGE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <Style x:Key="StepBadgeStyle" TargetType="Border">
            <Setter Property="Width"        Value="24"/>
            <Setter Property="Height"       Value="24"/>
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="Margin"       Value="0,0,8,0"/>
        </Style>

        <!-- â”€â”€â”€ BUTTON STYLES â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <Style x:Key="PrimaryBtnStyle" TargetType="Button">
            <Setter Property="Foreground"   Value="White"/>
            <Setter Property="FontFamily"   Value="Segoe UI"/>
            <Setter Property="FontSize"     Value="13"/>
            <Setter Property="FontWeight"   Value="SemiBold"/>
            <Setter Property="Padding"      Value="14,9"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor"       Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="Root"
                                Background="{TemplateBinding Background}"
                                CornerRadius="9"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Root" Property="Opacity" Value="0.88"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="Root" Property="Opacity" Value="0.72"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="Root" Property="Opacity" Value="0.38"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="GhostBtnStyle" TargetType="Button" BasedOn="{StaticResource PrimaryBtnStyle}">
            <Setter Property="Background" Value="#1A2C4A"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="Root"
                                Background="{TemplateBinding Background}"
                                BorderBrush="{StaticResource BorderNormal}"
                                BorderThickness="1"
                                CornerRadius="9"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Root" Property="BorderBrush" Value="{StaticResource BorderBright}"/>
                                <Setter TargetName="Root" Property="Opacity" Value="0.9"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="Root" Property="Opacity" Value="0.72"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="Root" Property="Opacity" Value="0.38"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- â”€â”€â”€ SECTION SEPARATOR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <Style x:Key="SectionLabelStyle" TargetType="TextBlock">
            <Setter Property="Foreground"       Value="{StaticResource TextMuted}"/>
            <Setter Property="FontFamily"       Value="Segoe UI"/>
            <Setter Property="FontSize"         Value="10"/>
            <Setter Property="FontWeight"       Value="Bold"/>


            <Setter Property="Margin"           Value="0,10,0,8"/>
        </Style>

        <!-- â”€â”€â”€ TOGGLE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <Style x:Key="ToggleStyle" TargetType="CheckBox">
            <Setter Property="Foreground"       Value="{StaticResource TextSecondary}"/>
            <Setter Property="FontFamily"       Value="Segoe UI"/>
            <Setter Property="FontSize"         Value="12"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>

        <!-- â”€â”€â”€ SCROLLBAR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
        <Style TargetType="ScrollBar">
            <Setter Property="Width"  Value="5"/>
            <Setter Property="Background" Value="Transparent"/>
        </Style>

    </Window.Resources>

    <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         ROOT CONTAINER
         â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <Border Background="{StaticResource AppGradient}"
            CornerRadius="16"
            BorderThickness="1"
            BorderBrush="#B9CDE3">

        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="58"/>
                <!-- Title bar          -->
                <RowDefinition Height="Auto"/>
                <!-- Color legend bar   -->
                <RowDefinition Height="*"/>
                <!-- Main content       -->
            </Grid.RowDefinitions>

            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                 ROW 0 â€” TITLE BAR
                 â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <Border Grid.Row="0"
                    Background="{StaticResource TitleBarGradient}"
                    CornerRadius="16,16,0,0"
                    BorderBrush="#1A3355"
                    BorderThickness="0,0,0,1"
                    MouseLeftButtonDown="TitleBar_MouseLeftButtonDown">

                <Grid Margin="16,0,6,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <!-- App identity -->
                    <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center">
                        <Border Width="32" Height="32" CornerRadius="16" Margin="0,0,10,0">
                            <Border.Background>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                    <GradientStop Color="#3B82F6" Offset="0"/>
                                    <GradientStop Color="#06CFEE" Offset="1"/>
                                </LinearGradientBrush>
                            </Border.Background>
                            <TextBlock Text="ðŸ›¡" HorizontalAlignment="Center" VerticalAlignment="Center" FontSize="16"/>
                        </Border>
                        <StackPanel VerticalAlignment="Center">
                            <TextBlock Text="Multi-Layer Spoofing Detector"
                                       Foreground="{StaticResource TextPrimary}"
                                       FontFamily="Segoe UI" FontSize="15" FontWeight="SemiBold"/>
                            <TextBlock x:Name="OperationalStatusText"
                                       Text="â— Platform ready â€” no active analysis"
                                       Foreground="{StaticResource TextSecondary}"
                                       FontFamily="Consolas" FontSize="11"/>
                        </StackPanel>
                    </StackPanel>

                    <!-- Date/time + theme -->
                    <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center">
                        <TextBlock x:Name="DateTimeText"
                                   Foreground="{StaticResource TextSecondary}"
                                   FontFamily="Consolas" FontSize="11"
                                   VerticalAlignment="Center"
                                   Margin="0,0,10,0"/>
                    </StackPanel>

                    <!-- Window controls -->
                    <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center">
                        <Button x:Name="MinimizeButton" Click="MinimizeButton_Click"
                                Width="36" Height="28"
                                Background="Transparent" Foreground="{StaticResource TextSecondary}"
                                BorderThickness="0" Cursor="Hand" ToolTip="Minimize"
                                Style="{StaticResource PrimaryBtnStyle}">
                            <TextBlock Text="â€”" FontSize="13" HorizontalAlignment="Center"/>
                        </Button>
                        <Button x:Name="MaximizeButton" Click="MaximizeButton_Click"
                                Width="36" Height="28"
                                Background="Transparent" Foreground="{StaticResource TextSecondary}"
                                BorderThickness="0" Cursor="Hand" ToolTip="Maximize/Restore"
                                Style="{StaticResource PrimaryBtnStyle}">
                            <Path x:Name="MaximizeIcon" Data="M1,1 L11,1 L11,11 L1,11 Z"
                                  Stroke="{StaticResource TextSecondary}" StrokeThickness="1.2"/>
                        </Button>
                        <Button x:Name="CloseButton" Click="CloseButton_Click"
                                Width="36" Height="28"
                                Background="Transparent" Foreground="{StaticResource TextSecondary}"
                                BorderThickness="0" Cursor="Hand" ToolTip="Close"
                                Style="{StaticResource PrimaryBtnStyle}">
                            <TextBlock Text="âœ•" FontSize="13" HorizontalAlignment="Center"/>
                        </Button>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                 ROW 1 â€” COLOR LEGEND / DESIGN KEY
                 Addresses panel feedback: "color scheme not dictated"
                 Every color is named and explained here.
                 â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <Border x:Name="LegendBarBorder" Grid.Row="1"
                    Background="#EAF2FB"
                    BorderBrush="#B9CDE3"
                    BorderThickness="0,0,0,1"
                    Padding="16,8">

                <WrapPanel Orientation="Horizontal" VerticalAlignment="Center">

                    <TextBlock Text="COLOR KEY"
                               Foreground="{StaticResource TextMuted}"
                               FontFamily="Segoe UI" FontSize="10" FontWeight="Bold"
                               
                               VerticalAlignment="Center"
                               Margin="0,0,14,0"/>

                    <!-- SAFE -->
                    <Border Background="#0C2820" CornerRadius="20" Padding="8,4" Margin="0,0,6,0"
                            BorderBrush="#1A6040" BorderThickness="1"
                            ToolTip="GREEN â€” Network or module is operating normally. No spoofing detected. Used on: status indicators, safe-state badges, nominal metric values.">
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <Ellipse Width="8" Height="8" Fill="{StaticResource SafeBrush}" Margin="0,0,6,0"/>
                            <TextBlock Text="SECURE / No Threat" Foreground="{StaticResource SafeBrush}"
                                       FontFamily="Segoe UI" FontSize="11" FontWeight="SemiBold"/>
                        </StackPanel>
                    </Border>

                    <!-- WARN -->
                    <Border Background="#2A1C08" CornerRadius="20" Padding="8,4" Margin="0,0,6,0"
                            BorderBrush="#6A4010" BorderThickness="1"
                            ToolTip="AMBER â€” Anomalous behaviour detected; not yet confirmed malicious. CVSS 4.0â€“6.9. Used on: medium-risk alerts, suspicious packet counts, caution indicators.">
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <Ellipse Width="8" Height="8" Fill="{StaticResource WarnBrush}" Margin="0,0,6,0"/>
                            <TextBlock Text="WARNING / Suspicious" Foreground="{StaticResource WarnBrush}"
                                       FontFamily="Segoe UI" FontSize="11" FontWeight="SemiBold"/>
                        </StackPanel>
                    </Border>

                    <!-- CRIT -->
                    <Border Background="#2A0A10" CornerRadius="20" Padding="8,4" Margin="0,0,6,0"
                            BorderBrush="#6A1020" BorderThickness="1"
                            ToolTip="RED â€” Active spoofing confirmed. Immediate action required. CVSS â‰¥ 7.0 or multi-layer attack. Used on: critical alerts, confirmed threat counts, CVSS high/critical scores.">
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <Ellipse Width="8" Height="8" Fill="{StaticResource CritBrush}" Margin="0,0,6,0"/>
                            <TextBlock Text="CRITICAL / Confirmed" Foreground="{StaticResource CritBrush}"
                                       FontFamily="Segoe UI" FontSize="11" FontWeight="SemiBold"/>
                        </StackPanel>
                    </Border>

                    <!-- INFO -->
                    <Border Background="#0E1E3A" CornerRadius="20" Padding="8,4" Margin="0,0,6,0"
                            BorderBrush="#1A3878" BorderThickness="1"
                            ToolTip="BLUE â€” Neutral informational highlight. Primary interactive elements (buttons, links). No threat implication.">
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <Ellipse Width="8" Height="8" Fill="{StaticResource InfoBrush}" Margin="0,0,6,0"/>
                            <TextBlock Text="Informational" Foreground="{StaticResource InfoBrush}"
                                       FontFamily="Segoe UI" FontSize="11" FontWeight="SemiBold"/>
                        </StackPanel>
                    </Border>

                    <!-- Separator -->
                    <Rectangle Width="1" Height="20" Fill="{StaticResource BorderNormal}" Margin="6,0"/>

                    <!-- Protocol layers -->
                    <TextBlock Text="PROTOCOL LAYERS:"
                               Foreground="{StaticResource TextMuted}"
                               FontFamily="Segoe UI" FontSize="10" FontWeight="Bold"
                               VerticalAlignment="Center"
                               Margin="4,0,10,0"/>

                    <Border Background="#160E2A" CornerRadius="20" Padding="8,4" Margin="0,0,6,0"
                            BorderBrush="#3D2870" BorderThickness="1"
                            ToolTip="PURPLE â€” ARP (Address Resolution Protocol) layer. Layer-2 MACâ€“IP binding. MITRE T1557.002 â€” ARP Cache Poisoning.">
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <Ellipse Width="8" Height="8" Fill="{StaticResource ArpBrush}" Margin="0,0,6,0"/>
                            <TextBlock Text="ARP  L2" Foreground="{StaticResource ArpBrush}"
                                       FontFamily="Consolas" FontSize="11" FontWeight="SemiBold"/>
                        </StackPanel>
                    </Border>

                    <Border Background="#071A28" CornerRadius="20" Padding="8,4" Margin="0,0,6,0"
                            BorderBrush="#0D4860" BorderThickness="1"
                            ToolTip="CYAN â€” DNS (Domain Name System) layer. Layer-7 name resolution. MITRE T1071.004 â€” DNS Cache Poisoning.">
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <Ellipse Width="8" Height="8" Fill="{StaticResource DnsBrush}" Margin="0,0,6,0"/>
                            <TextBlock Text="DNS  L7" Foreground="{StaticResource DnsBrush}"
                                       FontFamily="Consolas" FontSize="11" FontWeight="SemiBold"/>
                        </StackPanel>
                    </Border>

                    <Border Background="#0A1428" CornerRadius="20" Padding="8,4" Margin="0,0,6,0"
                            BorderBrush="#1A3468" BorderThickness="1"
                            ToolTip="LIGHT BLUE â€” IP (Internet Protocol) layer. Layer-3 source address forgery. MITRE T1036 â€” IP Address Masquerading.">
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <Ellipse Width="8" Height="8" Fill="{StaticResource IpBrush}" Margin="0,0,6,0"/>
                            <TextBlock Text="IP   L3" Foreground="{StaticResource IpBrush}"
                                       FontFamily="Consolas" FontSize="11" FontWeight="SemiBold"/>
                        </StackPanel>
                    </Border>

                    <!-- Hint -->
                    <Rectangle Width="1" Height="20" Fill="{StaticResource BorderNormal}" Margin="6,0"/>
                    <TextBlock Text="â“˜  Hover each chip for full description"
                               Foreground="{StaticResource TextMuted}"
                               FontFamily="Segoe UI" FontSize="10"
                               VerticalAlignment="Center"
                               Margin="8,0,0,0"/>

                </WrapPanel>
            </Border>

            <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                 ROW 2 â€” MAIN CONTENT AREA
                 â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
            <Grid x:Name="MainContentGrid" Grid.Row="2">
                <ScrollViewer x:Name="MainContentScrollViewer" VerticalScrollBarVisibility="Auto"
                              HorizontalScrollBarVisibility="Disabled"
                              Padding="16,14,16,14">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <!-- KPI strip         -->
                            <RowDefinition Height="Auto"/>
                            <!-- Workflow + charts -->
                            <RowDefinition Height="Auto"/>
                            <!-- Outputs + reports -->
                        </Grid.RowDefinitions>

                        <!-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
                             ROW A â€” KPI STRIP (4 metric cards)
                             â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
                        <Grid Grid.Row="2" Margin="0,12,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <!-- KPI 1: Network Risk -->
                            <Border Grid.Column="0" Style="{StaticResource CardStyle}" Margin="0,0,10,0" Background="{StaticResource BgPanel}">
                                <!-- Top accent line (color = current risk level) -->
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="3"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>
                                    <Rectangle Grid.Row="0" Fill="{StaticResource SafeBrush}"
                                               RadiusX="14" RadiusY="14" Margin="-18,-18,-18,0"/>
                                    <StackPanel Grid.Row="1" Margin="0,8,0,0">
                                        <TextBlock Text="OVERALL NETWORK RISK"
                                                   Foreground="{StaticResource TextMuted}"
                                                   FontFamily="Segoe UI" FontSize="10" FontWeight="Bold"
                                                   />
                                        <StackPanel Orientation="Horizontal" Margin="0,8,0,0" VerticalAlignment="Center">
                                            <Border x:Name="NetworkStatusIndicator"
                                                    Width="12" Height="12" CornerRadius="6"
                                                    Background="{StaticResource SafeBrush}"
                                                    Margin="0,2,10,0"/>
                                            <TextBlock x:Name="NetworkStatusText"
                                                       Text="0.0"
                                                       Style="{StaticResource KpiValueStyle}"
                                                       Foreground="{StaticResource SafeBrush}"/>
                                        </StackPanel>
                                        <TextBlock x:Name="LastScanText"
                                                   Text="Last scan: â€”"
                                                   Foreground="{StaticResource TextSecondary}"
                                                   FontFamily="Consolas" FontSize="11"
                                                   Margin="0,8,0,0"/>
                                        <Border Background="{StaticResource BgCardSoft}" CornerRadius="6" Padding="7,3" Margin="0,6,0,0" HorizontalAlignment="Left"
                                                BorderBrush="#1A6040" BorderThickness="1">
                                            <TextBlock x:Name="NetworkRiskBadge"
                                                       Text="â— All systems nominal"
                                                       Foreground="{StaticResource DarkGreen}"
                                                       FontFamily="Segoe UI" FontSize="11" FontWeight="SemiBold"/>
                                        </Border>
                                    </StackPanel>
                                </Grid>
                            </Border>

                            <!-- KPI 2: CVSS Score -->
                            <Border Grid.Column="1" Style="{StaticResource CardStyle}" Margin="0,0,10,0" Background="{StaticResource BgPanel}">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="3"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>
                                    <Rectangle Grid.Row="0" x:Name="CvssAccentBar"
                                               Fill="{StaticResource InfoBrush}"
                                               RadiusX="14" RadiusY="14" Margin="-18,-18,-18,0"/>
                                    <StackPanel Grid.Row="1" Margin="0,8,0,0">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="CVSS v3 SCORE"
                                                       Foreground="{StaticResource TextMuted}"
                                                       FontFamily="Segoe UI" FontSize="10" FontWeight="Bold"
                                                        VerticalAlignment="Center"/>
                                            <Border Background="{StaticResource BgBase}" CornerRadius="4" Padding="6,2" Margin="8,0,0,0"
                                                    VerticalAlignment="Center"
                                                    BorderBrush="{StaticResource BorderNormal}" BorderThickness="1">
                                                <TextBlock Text="0-10 scale" Foreground="{StaticResource TextSecondary}"
                                                           FontFamily="Segoe UI" FontSize="10" FontWeight="SemiBold"/>
                                            </Border>
                                        </StackPanel>
                                        <TextBlock x:Name="CvssScoreText"
                                                   Text="0.0"
                                                   Style="{StaticResource KpiValueStyle}"
                                                   Foreground="{StaticResource InfoBrush}"
                                                   Margin="0,8,0,0"/>
                                        <TextBlock x:Name="CvssRatingText"
                                                   Text=""
                                                   Foreground="{StaticResource TextSecondary}"
                                                   FontFamily="Segoe UI" FontSize="11"
                                                   Margin="0,2,0,0"/>
                                        <!-- Mini range bar -->
                                        <Grid Margin="0,8,0,0">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>
                                            <Border x:Name="CvssLevelLow" Grid.Column="0" Height="4" Background="#1A6040" CornerRadius="2,0,0,2"/>
                                            <Border x:Name="CvssLevelMedium" Grid.Column="1" Height="4" Background="#6A4010"/>
                                            <Border x:Name="CvssLevelHigh" Grid.Column="2" Height="4" Background="#6A1020"/>
                                            <Border x:Name="CvssLevelCritical" Grid.Column="3" Height="4" Background="#8B0020" CornerRadius="0,2,2,0"/>
                                        </Grid>
                                        <TextBlock Text="CVSS range indicator"
                                                   Foreground="{StaticResource TextMuted}"
                                                   FontFamily="Segoe UI" FontSize="9"
                                                   Margin="0,3,0,0"/>

                                        <Border Background="{StaticResource BgBase}" CornerRadius="6" Padding="8" Margin="0,8,0,0"
                                                BorderBrush="{StaticResource BorderNormal}" BorderThickness="1">
                                            <StackPanel>
                                                <TextBlock Text="MITRE ATT&amp;CK (current findings)"
                                                           Foreground="{StaticResource TextSecondary}"
                                                           FontFamily="Segoe UI" FontSize="10" FontWeight="SemiBold"
                                                           Margin="0,0,0,4"/>
                                                <ItemsControl x:Name="MitreBullets">
                                                    <ItemsControl.ItemTemplate>
                                                        <DataTemplate>
                                                            <TextBlock Text="{Binding StringFormat=â€¢ {0}}"
                                                                       Foreground="{StaticResource TextPrimary}"
                                                                       FontFamily="Consolas" FontSize="10"
                                                                       TextWrapping="Wrap" Margin="0,0,0,2"/>
                                                        </DataTemplate>
                                                    </ItemsControl.ItemTemplate>
                                                </ItemsControl>
                                            </StackPanel>
                                        </Border>

                                    </StackPanel>
                                </Grid>
                            </Border>

                            <!-- KPI 3: Traffic Insights -->
                            <Border Grid.Column="2" Style="{StaticResource CardStyle}" Margin="0,0,10,0" Background="{StaticResource BgPanel}">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="3"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>
                                    <Rectangle Grid.Row="0" Fill="{StaticResource WarnBrush}"
                                               RadiusX="14" RadiusY="14" Margin="-18,-18,-18,0"/>
                                    <StackPanel Grid.Row="1" Margin="0,8,0,0">
                                        <TextBlock Text="PACKETS ANALYZED"
                                                   Foreground="{StaticResource TextMuted}"
                                                   FontFamily="Segoe UI" FontSize="10" FontWeight="Bold"
                                                   />
                                        <TextBlock x:Name="PacketsAnalyzedText"
                                                   Text="0"
                                                   Style="{StaticResource KpiValueStyle}"
                                                   Foreground="{StaticResource WarnBrush}"
                                                   Margin="0,8,0,0"/>
                                        <TextBlock x:Name="TotalThreatsText"
                                                   Text="0 threats detected"
                                                   Style="{StaticResource BodyStyle}"
                                                   Margin="0,2,0,0"/>
                                        <StackPanel Orientation="Horizontal" Margin="0,8,0,0">
                                            <TextBlock x:Name="PktRateText"
                                                       Text="0 pkt/s avg"
                                                       Foreground="{StaticResource TextSecondary}"
                                                       FontFamily="Consolas" FontSize="11"/>
                                        </StackPanel>
                                    </StackPanel>
                                </Grid>
                            </Border>

                            <!-- KPI 4: Critical Alerts -->
                            <Border Grid.Column="3" Style="{StaticResource CardStyle}" Background="{StaticResource BgPanel}">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="3"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>
                                    <Rectangle Grid.Row="0" Fill="{StaticResource CritBrush}"
                                               RadiusX="14" RadiusY="14" Margin="-18,-18,-18,0"/>
                                    <StackPanel Grid.Row="1" Margin="0,8,0,0">
                                        <TextBlock Text="CRITICAL ALERTS"
                                                   Foreground="{StaticResource TextMuted}"
                                                   FontFamily="Segoe UI" FontSize="10" FontWeight="Bold"
                                                   />
                                        <TextBlock x:Name="CriticalAlertsText"
                                                   Text="0"
                                                   Style="{StaticResource KpiValueStyle}"
                                                   Foreground="{StaticResource CritBrush}"
                                                   Margin="0,8,0,0"/>
                                        <TextBlock Text="Requires immediate triage"
                                                   Foreground="{StaticResource TextSecondary}"
                                                   FontFamily="Segoe UI" FontSize="12"
                                                   Margin="0,2,0,0"/>
                                        <Border x:Name="CritAlertBadge"
                                                Background="{StaticResource BgCardSoft}" CornerRadius="6" Padding="7,3" Margin="0,6,0,0"
                                                HorizontalAlignment="Left"
                                                BorderBrush="#6A1020" BorderThickness="1">
                                            <TextBlock x:Name="CritAlertBadgeText"
                                                       Text="No active alerts"
                                                       Foreground="{StaticResource CritBrush}"
                                                       FontFamily="Segoe UI" FontSize="11" FontWeight="SemiBold"/>
                                        </Border>
                                    </StackPanel>
                                </Grid>
                            </Border>
                        </Grid>

                        <!-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
                             ROW B â€” THREE-COLUMN WORKFLOW + ANALYTICS
                             â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
                        <Grid Grid.Row="0" Margin="0,0,0,12">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="0.85*" MinWidth="280"/>
                                <!-- Left: workflow steps  -->
                                <ColumnDefinition Width="1.4*"  MinWidth="380"/>
                                <!-- Centre: analytics     -->
                                <ColumnDefinition Width="0.75*" MinWidth="240"/>
                                <!-- Right: alerts + cases -->
                            </Grid.ColumnDefinitions>

                            <!-- â”€â”€ LEFT COLUMN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
                            <StackPanel Grid.Column="0" Margin="0,0,12,0">

                                <!-- Step 1: Data Ingestion -->
                                <Border Style="{StaticResource CardStyle}">
                                    <StackPanel>
                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,4">
                                            <Border Style="{StaticResource StepBadgeStyle}">
                                                <Border.Background>
                                                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                                        <GradientStop Color="#3B82F6" Offset="0"/>
                                                        <GradientStop Color="#06CFEE" Offset="1"/>
                                                    </LinearGradientBrush>
                                                </Border.Background>
                                                <TextBlock Text="1" Foreground="White" HorizontalAlignment="Center"
                                                           VerticalAlignment="Center" FontFamily="Segoe UI"
                                                           FontSize="12" FontWeight="Bold"/>
                                            </Border>
                                            <TextBlock Text="Data Ingestion" Style="{StaticResource TitleStyle}" VerticalAlignment="Center"/>
                                        </StackPanel>
                                        <TextBlock Text="Upload a packet capture file. Supported: .pcap / .pcapng (max 500 MB)."
                                                   Style="{StaticResource SubTitleStyle}"/>

                                        <!-- Drop zone -->
                                        <Border x:Name="DropZoneBorder"
                                                Background="{StaticResource BgPanel}"
                                                BorderBrush="{StaticResource BorderBright}"
                                                BorderThickness="2"
                                                CornerRadius="10"
                                                Padding="10"
                                                Margin="0,0,0,8"
                                                Cursor="Hand"
                                                MouseLeftButtonDown="UploadPcapBtn_Click">
                                            <Border.Style>
                                                <Style TargetType="Border">
                                                    <Style.Triggers>
                                                        <Trigger Property="IsMouseOver" Value="True">
                                                            <Setter Property="Background" Value="#0C1F38"/>
                                                        </Trigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Border.Style>
                                            <StackPanel HorizontalAlignment="Center">
                                                <TextBlock Text="ðŸ“‚" 
                                                           FontSize="20"
                                                           HorizontalAlignment="Center" 
                                                           Margin="0,0,0,6" />
                                                <TextBlock Text="Drop file here or click to browse"
                                                           FontFamily="Segoe UI" FontSize="12" FontWeight="SemiBold"
                                                           HorizontalAlignment="Center"/>
                                                <TextBlock Text=".pcap  Â·  .pcapng  Â·  max 500 MB"
                                                           FontFamily="Segoe UI" FontSize="11"
                                                           HorizontalAlignment="Center" Margin="0,4,0,0"/>
                                            </StackPanel>
                                        </Border>

                                        <!-- File info (shown after upload) -->
                                        <Border x:Name="FileInfoPanel"
                                                Background="{StaticResource BgPanel}"
                                                BorderBrush="{StaticResource BorderBright}"
                                                BorderThickness="1"
                                                CornerRadius="9" Padding="12"
                                                Visibility="Collapsed"
                                                Margin="0,0,0,10">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                <StackPanel>
                                                    <TextBlock Text="SELECTED FILE"
                                                               Foreground="{StaticResource TextMuted}"
                                                               FontFamily="Segoe UI" FontSize="10" FontWeight="Bold"/>
                                                    <TextBlock x:Name="FileNameText"
                                                               Text="â€”"
                                                               FontFamily="Consolas" FontSize="12" FontWeight="SemiBold"
                                                               Margin="0,4,0,0"/>
                                                    <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                                                        <Ellipse x:Name="FileStatusDot" Width="7" Height="7"
                                                                 Fill="#FF000000" Margin="0,1,6,0"/>
                                                        <TextBlock x:Name="FileStatusText"
                                                                   Text="Valid PCAP"
                                                                   FontFamily="Segoe UI" FontSize="11"/>
                                                    </StackPanel>
                                                </StackPanel>
                                                <TextBlock x:Name="FileSizeText"
                                                           Grid.Column="1"
                                                           Text="0 MB"
                                                           Foreground="{StaticResource TextSecondary}"
                                                           FontFamily="Consolas" FontSize="12"
                                                           VerticalAlignment="Center"/>
                                            </Grid>
                                        </Border>

                                        <Border Background="{StaticResource BgPanel}" CornerRadius="8" Padding="10,8">
                                            <TextBlock x:Name="UploadModuleStatus"
                                                       Text="âœ“  Ready to accept PCAP files"
                                                       FontFamily="Segoe UI" FontSize="12"/>
                                        </Border>
                                    </StackPanel>
                                </Border>

                                <!-- Step 2: Packet Analysis -->
                                <Border Style="{StaticResource CardStyle}">
                                    <StackPanel>
                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,4">
                                            <Border Style="{StaticResource StepBadgeStyle}">
                                                <Border.Background>
                                                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                                        <GradientStop Color="#3B82F6" Offset="0"/>
                                                        <GradientStop Color="#06CFEE" Offset="1"/>
                                                    </LinearGradientBrush>
                                                </Border.Background>
                                                <TextBlock Text="2" Foreground="White" HorizontalAlignment="Center"
                                                           VerticalAlignment="Center" FontFamily="Segoe UI"
                                                           FontSize="12" FontWeight="Bold"/>
                                            </Border>
                                            <TextBlock Text="Packet Analysis" Style="{StaticResource TitleStyle}" VerticalAlignment="Center"/>
                                        </StackPanel>
                                        <TextBlock Text="AI pipeline extracts flow-level features and runs multi-layer spoofing inference across ARP, DNS, and IP simultaneously."
                                                   Style="{StaticResource SubTitleStyle}"/>

                                        <Button x:Name="AnalyzeBtn"
                                                Content="â–¶  Run AI Detection Pipeline"
                                                Padding="10,7"
                                                Background="{StaticResource AccentBrush}"
                                                Foreground="#07111E"
                                                Style="{StaticResource PrimaryBtnStyle}"
                                                Click="AnalyzeBtn_Click"
                                                IsEnabled="False"
                                                Margin="0,0,0,10"
                                                HorizontalAlignment="Stretch"/>

                                        <TextBlock x:Name="AnalysisModuleStatus"
                                                   Text="â¸  Waiting for PCAP file"
                                                   Foreground="{StaticResource WarnBrush}"
                                                   FontFamily="Segoe UI" FontSize="12"
                                                   Margin="0,0,0,8"/>
                                        <TextBlock x:Name="AnalysisModuleDetails"
                                                   Text="Upload a file to enable the pipeline."
                                                   FontFamily="Segoe UI" FontSize="11"
                                                   TextWrapping="Wrap"/>
                                    </StackPanel>
                                </Border>

                                <!-- Step 3: Detection Layers -->
                                <Border Style="{StaticResource CardStyle}">
                                    <StackPanel>
                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,4">
                                            <Border Style="{StaticResource StepBadgeStyle}">
                                                <Border.Background>
                                                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                                        <GradientStop Color="#3B82F6" Offset="0"/>
                                                        <GradientStop Color="#06CFEE" Offset="1"/>
                                                    </LinearGradientBrush>
                                                </Border.Background>
                                                <TextBlock Text="3" Foreground="White" HorizontalAlignment="Center"
                                                           VerticalAlignment="Center" FontFamily="Segoe UI"
                                                           FontSize="12" FontWeight="Bold"/>
                                            </Border>
                                            <TextBlock Text="Detection Layers" Style="{StaticResource TitleStyle}" VerticalAlignment="Center"/>
                                        </StackPanel>

                                        <TextBlock Margin="0,0,0,4"
                                                   Foreground="{StaticResource TextSecondary}"
                                                   FontFamily="Segoe UI" FontSize="11"
                                                   TextWrapping="Wrap">
                                            Status indicators: protocol color = normal. <Run Foreground="{StaticResource WarnBrush}" FontWeight="SemiBold">Amber</Run> = suspicious (mostly medium findings). <Run Foreground="{StaticResource CritBrush}" FontWeight="SemiBold">Red</Run> = confirmed/high-confidence anomalies.
                                        </TextBlock>

                                        <TextBlock x:Name="DetectionModuleStatus"
                                                   Text="Status: Idle â€” run pipeline to activate"
                                                   Foreground="{StaticResource TextSecondary}"
                                                   FontFamily="Consolas" FontSize="11"
                                                   Margin="0,0,0,12"/>

                                        <!-- ARP Layer row -->
                                        <Border Background="{StaticResource BgCardSoft}"
                                                CornerRadius="9" Padding="12,10" Margin="0,0,0,6"
                                                BorderBrush="{StaticResource BorderNormal}" BorderThickness="1">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                <Ellipse x:Name="ArpDetectionIndicator" Width="10" Height="10"
                                                         Fill="{StaticResource ArpBrush}"
                                                         Margin="0,0,10,0" VerticalAlignment="Center"/>
                                                <StackPanel Grid.Column="1">
                                                    <TextBlock Text="ARP Spoofing"
                                                               Foreground="{StaticResource TextPrimary}"
                                                               FontFamily="Segoe UI" FontSize="13" FontWeight="SemiBold"/>
                                                    <TextBlock Text="Layer 2 Â· MAC-IP binding"
                                                               Foreground="{StaticResource ArpBrush}"
                                                               FontFamily="Segoe UI" FontSize="10"/>
                                                </StackPanel>
                                                <TextBlock x:Name="ArpThreatCount"
                                                           Grid.Column="2"
                                                           Text="â€”"
                                                           Foreground="{StaticResource TextMuted}"
                                                           FontFamily="Consolas" FontSize="12"
                                                           VerticalAlignment="Center" Margin="0,0,10,0"/>
                                                <TextBlock x:Name="ArpLayerStatus"
                                                           Grid.Column="3"
                                                           Text="IDLE"
                                                           Foreground="{StaticResource TextMuted}"
                                                           FontFamily="Consolas" FontSize="11" FontWeight="Bold"
                                                           VerticalAlignment="Center"/>
                                            </Grid>
                                        </Border>

                                        <!-- DNS Layer row -->
                                        <Border Background="{StaticResource BgCardSoft}"
                                                CornerRadius="9" Padding="12,10" Margin="0,0,0,6"
                                                BorderBrush="{StaticResource BorderNormal}" BorderThickness="1">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                <Ellipse x:Name="DnsDetectionIndicator" Width="10" Height="10"
                                                         Fill="{StaticResource DnsBrush}"
                                                         Margin="0,0,10,0" VerticalAlignment="Center"/>
                                                <StackPanel Grid.Column="1">
                                                    <TextBlock Text="DNS Spoofing"
                                                               Foreground="{StaticResource TextPrimary}"
                                                               FontFamily="Segoe UI" FontSize="13" FontWeight="SemiBold"/>
                                                    <TextBlock Text="Layer 7 Â· Name resolution"
                                                               Foreground="{StaticResource DnsBrush}"
                                                               FontFamily="Segoe UI" FontSize="10"/>
                                                </StackPanel>
                                                <TextBlock x:Name="DnsThreatCount"
                                                           Grid.Column="2"
                                                           Text="â€”"
                                                           Foreground="{StaticResource TextMuted}"
                                                           FontFamily="Consolas" FontSize="12"
                                                           VerticalAlignment="Center" Margin="0,0,10,0"/>
                                                <TextBlock x:Name="DnsLayerStatus"
                                                           Grid.Column="3"
                                                           Text="IDLE"
                                                           Foreground="{StaticResource TextMuted}"
                                                           FontFamily="Consolas" FontSize="11" FontWeight="Bold"
                                                           VerticalAlignment="Center"/>
                                            </Grid>
                                        </Border>

                                        <!-- IP Layer row -->
                                        <Border Background="{StaticResource BgCardSoft}"
                                                CornerRadius="9" Padding="12,10" Margin="0,0,0,0"
                                                BorderBrush="{StaticResource BorderNormal}" BorderThickness="1">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                <Ellipse x:Name="IpDetectionIndicator" Width="10" Height="10"
                                                         Fill="{StaticResource IpBrush}"
                                                         Margin="0,0,10,0" VerticalAlignment="Center"/>
                                                <StackPanel Grid.Column="1">
                                                    <TextBlock Text="IP Spoofing"
                                                               Foreground="{StaticResource TextPrimary}"
                                                               FontFamily="Segoe UI" FontSize="13" FontWeight="SemiBold"/>
                                                    <TextBlock Text="Layer 3 Â· Source address forgery"
                                                               Foreground="{StaticResource IpBrush}"
                                                               FontFamily="Segoe UI" FontSize="10"/>
                                                </StackPanel>
                                                <TextBlock x:Name="IpThreatCount"
                                                           Grid.Column="2"
                                                           Text="â€”"
                                                           Foreground="{StaticResource TextMuted}"
                                                           FontFamily="Consolas" FontSize="12"
                                                           VerticalAlignment="Center" Margin="0,0,10,0"/>
                                                <TextBlock x:Name="IpLayerStatus"
                                                           Grid.Column="3"
                                                           Text="IDLE"
                                                           Foreground="{StaticResource TextMuted}"
                                                           FontFamily="Consolas" FontSize="11" FontWeight="Bold"
                                                           VerticalAlignment="Center"/>
                                            </Grid>
                                        </Border>
                                    </StackPanel>
                                </Border>

                            </StackPanel>

                            <!-- â”€â”€ CENTRE COLUMN: ANALYTICS â”€â”€â”€â”€â”€â”€ -->
                            <StackPanel Grid.Column="1" Margin="0,0,12,0">

                            <!-- Detection Outputs -->
                            <Border Grid.Column="0" Style="{StaticResource CardStyle}" Margin="0,0,12,0">
                                <StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,2">
                                        <TextBlock Text="ðŸ”" FontSize="15" Margin="0,0,8,0" VerticalAlignment="Center"/>
                                        <TextBlock Text="Detection Outputs" Style="{StaticResource TitleStyle}" VerticalAlignment="Center"/>
                                    </StackPanel>
                                    <TextBlock FontFamily="Segoe UI" FontSize="11" Margin="0,0,0,12" TextWrapping="Wrap">
                                        <Run Foreground="{StaticResource TextSecondary}">Structured findings per spoofing class. Values in</Run>
                                        <Run Foreground="{StaticResource SafeBrush}" FontWeight="SemiBold">green</Run>
                                        <Run Foreground="{StaticResource TextSecondary}">= benign,</Run>
                                        <Run Foreground="{StaticResource WarnBrush}" FontWeight="SemiBold">amber</Run>
                                        <Run Foreground="{StaticResource TextSecondary}">= suspicious,</Run>
                                        <Run Foreground="{StaticResource CritBrush}" FontWeight="SemiBold">red</Run>
                                        <Run Foreground="{StaticResource TextSecondary}">= confirmed threat.</Run>
                                    </TextBlock>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>

                                        <!-- ARP -->
                                        <Border Grid.Column="0"
                                                Background="{StaticResource BgBase}"
                                                BorderBrush="#3D2870" BorderThickness="1"
                                                CornerRadius="10" Padding="12" Margin="0,0,8,0">
                                            <StackPanel>
                                                <StackPanel Orientation="Horizontal" Margin="0,0,0,18">
                                                    <Border Background="#160E2A" CornerRadius="6" Padding="7,3"
                                                            Margin="0,0,0,0">
                                                        <StackPanel Orientation="Horizontal">
                                                            <Ellipse Width="8" Height="8" Fill="{StaticResource ArpBrush}" Margin="0,0,6,0" VerticalAlignment="Center"/>
                                                            <TextBlock Text="ARP  Layer 2"
                                                                       Foreground="{StaticResource ArpBrush}"
                                                                       FontFamily="Consolas" FontSize="11" FontWeight="Bold"/>
                                                        </StackPanel>
                                                    </Border>
                                                </StackPanel>
                                                <ScrollViewer VerticalScrollBarVisibility="Auto" MaxHeight="220"><StackPanel x:Name="ArpResultsPanel">
                                                    <Grid Margin="0,0,0,6">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="*"/>
                                                            <ColumnDefinition Width="Auto"/>
                                                        </Grid.ColumnDefinitions>
                                                        <TextBlock Text="Gratuitous ARPs" Foreground="{StaticResource TextSecondary}" FontFamily="Segoe UI" FontSize="12"/>
                                                        <TextBlock x:Name="ArpGratuitousText" Grid.Column="1" Text="â€”" Foreground="{StaticResource TextMuted}" FontFamily="Consolas" FontSize="12" FontWeight="Bold"/>
                                                    </Grid>
                                                    <Grid Margin="0,0,0,6">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="*"/>
                                                            <ColumnDefinition Width="Auto"/>
                                                        </Grid.ColumnDefinitions>
                                                        <TextBlock Text="MACâ€“IP conflicts" Foreground="{StaticResource TextSecondary}" FontFamily="Segoe UI" FontSize="12"/>
                                                        <TextBlock x:Name="ArpConflictsText" Grid.Column="1" Text="â€”" Foreground="{StaticResource TextMuted}" FontFamily="Consolas" FontSize="12" FontWeight="Bold"/>
                                                    </Grid>
                                                    <Grid Margin="0,0,0,6">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="*"/>
                                                            <ColumnDefinition Width="Auto"/>
                                                        </Grid.ColumnDefinitions>
                                                        <TextBlock Text="Poison attempts" Foreground="{StaticResource TextSecondary}" FontFamily="Segoe UI" FontSize="12"/>
                                                        <TextBlock x:Name="ArpPoisonText" Grid.Column="1" Text="â€”" Foreground="{StaticResource TextMuted}" FontFamily="Consolas" FontSize="12" FontWeight="Bold"/>
                                                    </Grid>
                                                    <Grid>
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="*"/>
                                                            <ColumnDefinition Width="Auto"/>
                                                        </Grid.ColumnDefinitions>
                                                        <TextBlock Text="Confidence" Foreground="{StaticResource TextSecondary}" FontFamily="Segoe UI" FontSize="12"/>
                                                        <TextBlock x:Name="ArpConfText" Grid.Column="1" Text="â€”" Foreground="{StaticResource TextMuted}" FontFamily="Consolas" FontSize="12" FontWeight="Bold"/>
                                                    </Grid>
                                                </StackPanel></ScrollViewer>
                                            </StackPanel>
                                        </Border>

                                        <!-- DNS -->
                                        <Border Grid.Column="1"
                                                Background="{StaticResource BgBase}"
                                                BorderBrush="#0D4860" BorderThickness="1"
                                                CornerRadius="10" Padding="12" Margin="0,0,8,0">
                                            <StackPanel>
                                                <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                                    <Border Background="#071A28" CornerRadius="6" Padding="7,3">
                                                        <StackPanel Orientation="Horizontal">
                                                            <Ellipse Width="8" Height="8" Fill="{StaticResource DnsBrush}" Margin="0,0,6,0" VerticalAlignment="Center"/>
                                                            <TextBlock Text="DNS  Layer 7"
                                                                       Foreground="{StaticResource DnsBrush}"
                                                                       FontFamily="Consolas" FontSize="11" FontWeight="Bold"/>
                                                        </StackPanel>
                                                    </Border>
                                                </StackPanel>
                                                <ScrollViewer VerticalScrollBarVisibility="Auto" MaxHeight="220"><StackPanel x:Name="DnsResultsPanel">
                                                    <Grid Margin="0,0,0,6">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="*"/>
                                                            <ColumnDefinition Width="Auto"/>
                                                        </Grid.ColumnDefinitions>
                                                        <TextBlock Text="Resp w/o query" Foreground="{StaticResource TextSecondary}" FontFamily="Segoe UI" FontSize="12"/>
                                                        <TextBlock x:Name="DnsNoQueryText" Grid.Column="1" Text="â€”" Foreground="{StaticResource TextMuted}" FontFamily="Consolas" FontSize="12" FontWeight="Bold"/>
                                                    </Grid>
                                                    <Grid Margin="0,0,0,6">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="*"/>
                                                            <ColumnDefinition Width="Auto"/>
                                                        </Grid.ColumnDefinitions>
                                                        <TextBlock Text="TTL anomalies" Foreground="{StaticResource TextSecondary}" FontFamily="Segoe UI" FontSize="12"/>
                                                        <TextBlock x:Name="DnsTtlText" Grid.Column="1" Text="â€”" Foreground="{StaticResource TextMuted}" FontFamily="Consolas" FontSize="12" FontWeight="Bold"/>
                                                    </Grid>
                                                    <Grid Margin="0,0,0,6">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="*"/>
                                                            <ColumnDefinition Width="Auto"/>
                                                        </Grid.ColumnDefinitions>
                                                        <TextBlock Text="Rogue resolvers" Foreground="{StaticResource TextSecondary}" FontFamily="Segoe UI" FontSize="12"/>
                                                        <TextBlock x:Name="DnsRogueText" Grid.Column="1" Text="â€”" Foreground="{StaticResource TextMuted}" FontFamily="Consolas" FontSize="12" FontWeight="Bold"/>
                                                    </Grid>
                                                    <Grid>
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="*"/>
                                                            <ColumnDefinition Width="Auto"/>
                                                        </Grid.ColumnDefinitions>
                                                        <TextBlock Text="Confidence" Foreground="{StaticResource TextSecondary}" FontFamily="Segoe UI" FontSize="12"/>
                                                        <TextBlock x:Name="DnsConfText" Grid.Column="1" Text="â€”" Foreground="{StaticResource TextMuted}" FontFamily="Consolas" FontSize="12" FontWeight="Bold"/>
                                                    </Grid>
                                                </StackPanel></ScrollViewer>
                                            </StackPanel>
                                        </Border>

                                        <!-- IP -->
                                        <Border Grid.Column="2"
                                                Background="{StaticResource BgBase}"
                                                BorderBrush="#1A3468" BorderThickness="1"
                                                CornerRadius="10" Padding="12">
                                            <StackPanel>
                                                <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                                    <Border Background="#0A1428" CornerRadius="6" Padding="7,3">
                                                        <StackPanel Orientation="Horizontal">
                                                            <Ellipse Width="8" Height="8" Fill="{StaticResource IpBrush}" Margin="0,0,6,0" VerticalAlignment="Center"/>
                                                            <TextBlock Text="IP   Layer 3"
                                                                       Foreground="{StaticResource IpBrush}"
                                                                       FontFamily="Consolas" FontSize="11" FontWeight="Bold"/>
                                                        </StackPanel>
                                                    </Border>
                                                </StackPanel>
                                                <ScrollViewer VerticalScrollBarVisibility="Auto" MaxHeight="220"><StackPanel x:Name="IpResultsPanel">
                                                    <Grid Margin="0,0,0,6">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="*"/>
                                                            <ColumnDefinition Width="Auto"/>
                                                        </Grid.ColumnDefinitions>
                                                        <TextBlock Text="Src addr forgeries" Foreground="{StaticResource TextSecondary}" FontFamily="Segoe UI" FontSize="12"/>
                                                        <TextBlock x:Name="IpSpoofedText" Grid.Column="1" Text="â€”" Foreground="{StaticResource TextMuted}" FontFamily="Consolas" FontSize="12" FontWeight="Bold"/>
                                                    </Grid>
                                                    <Grid Margin="0,0,0,6">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="*"/>
                                                            <ColumnDefinition Width="Auto"/>
                                                        </Grid.ColumnDefinitions>
                                                        <TextBlock Text="TTL inconsist." Foreground="{StaticResource TextSecondary}" FontFamily="Segoe UI" FontSize="12"/>
                                                        <TextBlock x:Name="IpTtlText" Grid.Column="1" Text="â€”" Foreground="{StaticResource TextMuted}" FontFamily="Consolas" FontSize="12" FontWeight="Bold"/>
                                                    </Grid>
                                                    <Grid Margin="0,0,0,6">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="*"/>
                                                            <ColumnDefinition Width="Auto"/>
                                                        </Grid.ColumnDefinitions>
                                                        <TextBlock Text="Bogon sources" Foreground="{StaticResource TextSecondary}" FontFamily="Segoe UI" FontSize="12"/>
                                                        <TextBlock x:Name="IpBogonText" Grid.Column="1" Text="â€”" Foreground="{StaticResource TextMuted}" FontFamily="Consolas" FontSize="12" FontWeight="Bold"/>
                                                    </Grid>
                                                    <Grid>
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="*"/>
                                                            <ColumnDefinition Width="Auto"/>
                                                        </Grid.ColumnDefinitions>
                                                        <TextBlock Text="Confidence" Foreground="{StaticResource TextSecondary}" FontFamily="Segoe UI" FontSize="12"/>
                                                        <TextBlock x:Name="IpConfText" Grid.Column="1" Text="â€”" Foreground="{StaticResource TextMuted}" FontFamily="Consolas" FontSize="12" FontWeight="Bold"/>
                                                    </Grid>
                                                </StackPanel></ScrollViewer>
                                            </StackPanel>
                                        </Border>
                                    </Grid>
                                </StackPanel>
                            </Border>


                                <!-- Analytics & Insights Card -->
                                <Border Style="{StaticResource CardStyle}">
                                    <StackPanel>
                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,2">
                                            <TextBlock Text="ðŸ“Š" FontSize="16" Margin="0,0,8,0" VerticalAlignment="Center"/>
                                            <TextBlock Text="Analytics &amp; Insights" Style="{StaticResource TitleStyle}" VerticalAlignment="Center"/>
                                        </StackPanel>
                                        <TextBlock Text="Real-time statistical breakdown of captured traffic and detection findings. All charts populate after analysis."
                                                   Style="{StaticResource SubTitleStyle}"/>

                                        <!-- 2Ã—2 chart grid -->
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>

                                            <!-- Chart A: Threat Timeline -->
                                            <Border Grid.Column="0" Grid.Row="0"
                                                    MinHeight="260"
                                                    Background="{StaticResource BgBase}"
                                                    BorderBrush="{StaticResource BorderNormal}" BorderThickness="1"
                                                    CornerRadius="10" Padding="12" Margin="0,0,6,6">
                                                <StackPanel>
                                                    <Grid Margin="0,0,0,8">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="*"/>
                                                            <ColumnDefinition Width="Auto"/>
                                                        </Grid.ColumnDefinitions>
                                                        <TextBlock Text="Threat Timeline"
                                                                   Foreground="{StaticResource TextPrimary}"
                                                                   FontFamily="Segoe UI" FontSize="12" FontWeight="SemiBold"/>
                                                        <TextBlock Grid.Column="1"
                                                                   Text="events / min"
                                                                   Foreground="{StaticResource TextMuted}"
                                                                   FontFamily="Segoe UI" FontSize="10"/>
                                                    </Grid>
                                                    <!-- LiveCharts CartesianChart â€” bind in code-behind -->
                                                    <lvc:CartesianChart x:Name="ThreatTimelineChart"
                                                                        Height="200"
                                                                        DisableAnimations="True"
                                                                        Hoverable="False"
                                                                        DataTooltip="{x:Null}">
                                                        <lvc:CartesianChart.AxisX>
                                                            <lvc:Axis x:Name="TimelineAxisX"
                                                                      Foreground="{StaticResource TextMuted}"
                                                                      FontSize="9"
                                                                      ShowLabels="True"/>
                                                        </lvc:CartesianChart.AxisX>
                                                        <lvc:CartesianChart.AxisY>
                                                            <lvc:Axis Foreground="{StaticResource TextMuted}"
                                                                      FontSize="9"
                                                                      MinValue="0"/>
                                                        </lvc:CartesianChart.AxisY>
                                                    </lvc:CartesianChart>
                                                    <StackPanel Orientation="Horizontal" Margin="0,6,0,0">
                                                        <Ellipse Width="8" Height="8" Fill="{StaticResource InfoBrush}" Margin="0,0,5,0" VerticalAlignment="Center"/>
                                                        <TextBlock Text="Total" Foreground="{StaticResource TextMuted}" FontFamily="Segoe UI" FontSize="10" Margin="0,0,12,0"/>
                                                        <Ellipse Width="8" Height="8" Fill="{StaticResource CritBrush}" Margin="0,0,5,0" VerticalAlignment="Center"/>
                                                        <TextBlock Text="Flagged" Foreground="{StaticResource TextMuted}" FontFamily="Segoe UI" FontSize="10"/>
                                                    </StackPanel>
                                                </StackPanel>
                                            </Border>

                                            <!-- Chart B: Protocol Distribution -->
                                            <Border Grid.Column="1" Grid.Row="0"
                                                    MinHeight="260"
                                                    Background="{StaticResource BgBase}"
                                                    BorderBrush="{StaticResource BorderNormal}" BorderThickness="1"
                                                    CornerRadius="10" Padding="12" Margin="0,0,0,6">
                                                <StackPanel>
                                                    <Grid Margin="0,0,0,8">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="*"/>
                                                            <ColumnDefinition Width="Auto"/>
                                                        </Grid.ColumnDefinitions>
                                                        <TextBlock Text="Protocol Distribution"
                                                                   Foreground="{StaticResource TextPrimary}"
                                                                   FontFamily="Segoe UI" FontSize="12" FontWeight="SemiBold"/>
                                                        <TextBlock Grid.Column="1"
                                                                   Text="% of packets"
                                                                   Foreground="{StaticResource TextMuted}"
                                                                   FontFamily="Segoe UI" FontSize="10"/>
                                                    </Grid>
                                                    <Grid>
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="Auto"/>
                                                            <ColumnDefinition Width="*"/>
                                                        </Grid.ColumnDefinitions>
                                                        <lvc:PieChart x:Name="ProtocolPieChart"
                                                                      Width="170" Height="170"
                                                                      InnerRadius="38"
                                                                      DisableAnimations="True"
                                                                      Hoverable="False"
                                                                      DataTooltip="{x:Null}"
                                                                      Margin="0,0,12,0"/>
                                                        <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                                            <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                                                <Rectangle Width="10" Height="10" Fill="{StaticResource ArpBrush}"
                                                                           RadiusX="2" RadiusY="2" Margin="0,0,7,0"/>
                                                                <TextBlock Text="ARP" Foreground="{StaticResource TextSecondary}"
                                                                           FontFamily="Segoe UI" FontSize="12" Margin="0,0,8,0"/>
                                                                <TextBlock x:Name="ArpPctText" Text="â€”%"
                                                                           Foreground="{StaticResource ArpBrush}"
                                                                           FontFamily="Consolas" FontSize="12" FontWeight="Bold"/>
                                                            </StackPanel>
                                                            <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                                                                <Rectangle Width="10" Height="10" Fill="{StaticResource DnsBrush}"
                                                                           RadiusX="2" RadiusY="2" Margin="0,0,7,0"/>
                                                                <TextBlock Text="DNS" Foreground="{StaticResource TextSecondary}"
                                                                           FontFamily="Segoe UI" FontSize="12" Margin="0,0,8,0"/>
                                                                <TextBlock x:Name="DnsPctText" Text="â€”%"
                                                                           Foreground="{StaticResource DnsBrush}"
                                                                           FontFamily="Consolas" FontSize="12" FontWeight="Bold"/>
                                                            </StackPanel>
                                                            <StackPanel Orientation="Horizontal">
                                                                <Rectangle Width="10" Height="10" Fill="{StaticResource IpBrush}"
                                                                           RadiusX="2" RadiusY="2" Margin="0,0,7,0"/>
                                                                <TextBlock Text="IP " Foreground="{StaticResource TextSecondary}"
                                                                           FontFamily="Segoe UI" FontSize="12" Margin="0,0,8,0"/>
                                                                <TextBlock x:Name="IpPctText" Text="â€”%"
                                                                           Foreground="{StaticResource IpBrush}"
                                                                           FontFamily="Consolas" FontSize="12" FontWeight="Bold"/>
                                                            </StackPanel>
                                                        </StackPanel>
                                                    </Grid>
                                                </StackPanel>
                                            </Border>

                                            <!-- Chart C: Packet Flow -->
                                            <Border Grid.Column="0" Grid.Row="1"
                                                    MinHeight="260"
                                                    Background="{StaticResource BgBase}"
                                                    BorderBrush="{StaticResource BorderNormal}" BorderThickness="1"
                                                    CornerRadius="10" Padding="12" Margin="0,0,6,0">
                                                <StackPanel>
                                                    <Grid Margin="0,0,0,8">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="*"/>
                                                            <ColumnDefinition Width="Auto"/>
                                                        </Grid.ColumnDefinitions>
                                                        <TextBlock Text="Packet Flow"
                                                                   Foreground="{StaticResource TextPrimary}"
                                                                   FontFamily="Segoe UI" FontSize="12" FontWeight="SemiBold"/>
                                                        <TextBlock Grid.Column="1"
                                                                   Text="anomalies by protocol"
                                                                   Foreground="{StaticResource TextMuted}"
                                                                   FontFamily="Segoe UI" FontSize="10"/>
                                                    </Grid>
                                                    <lvc:CartesianChart x:Name="PacketFlowChart"
                                                                        Height="200"
                                                                        DisableAnimations="True"
                                                                        Hoverable="False"
                                                                        DataTooltip="{x:Null}">
                                                        <lvc:CartesianChart.AxisX>
                                                            <lvc:Axis Foreground="{StaticResource TextMuted}"
                                                                      FontSize="9" ShowLabels="False"/>
                                                        </lvc:CartesianChart.AxisX>
                                                        <lvc:CartesianChart.AxisY>
                                                            <lvc:Axis Foreground="{StaticResource TextMuted}"
                                                                      FontSize="9" MinValue="0"/>
                                                        </lvc:CartesianChart.AxisY>
                                                    </lvc:CartesianChart>
                                                    <StackPanel Orientation="Horizontal" Margin="0,6,0,0">
                                                        <Ellipse Width="8" Height="8" Fill="{StaticResource ArpBrush}" Margin="0,0,5,0" VerticalAlignment="Center"/>
                                                        <TextBlock Text="ARP" Foreground="{StaticResource TextMuted}" FontFamily="Segoe UI" FontSize="10" Margin="0,0,12,0"/>
                                                        <Ellipse Width="8" Height="8" Fill="{StaticResource DnsBrush}" Margin="0,0,5,0" VerticalAlignment="Center"/>
                                                        <TextBlock Text="DNS" Foreground="{StaticResource TextMuted}" FontFamily="Segoe UI" FontSize="10" Margin="0,0,12,0"/>
                                                        <Ellipse Width="8" Height="8" Fill="{StaticResource IpBrush}" Margin="0,0,5,0" VerticalAlignment="Center"/>
                                                        <TextBlock Text="IP" Foreground="{StaticResource TextMuted}" FontFamily="Segoe UI" FontSize="10"/>
                                                    </StackPanel>
                                                </StackPanel>
                                            </Border>

                                            <!-- Chart D: CVSS Breakdown -->
                                            <Border Grid.Column="1" Grid.Row="1"
                                                    Background="{StaticResource BgBase}"
                                                    BorderBrush="{StaticResource BorderNormal}" BorderThickness="1"
                                                    CornerRadius="10" Padding="12" Margin="0,0,0,0">
                                                <StackPanel>
                                                    <Grid Margin="0,0,0,8">
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="*"/>
                                                            <ColumnDefinition Width="Auto"/>
                                                        </Grid.ColumnDefinitions>
                                                        <TextBlock Text="CVSS v3 Breakdown"
                                                                   Foreground="{StaticResource TextPrimary}"
                                                                   FontFamily="Segoe UI" FontSize="12" FontWeight="SemiBold"/>
                                                        <TextBlock Grid.Column="1"
                                                                   Text="per vector"
                                                                   Foreground="{StaticResource TextMuted}"
                                                                   FontFamily="Segoe UI" FontSize="10"/>
                                                    </Grid>
                                                    <!-- Per-vector mini bars -->
                                                    <StackPanel Margin="0,0,0,6">
                                                        <!-- Attack Vector -->
                                                        <Grid Margin="0,0,0,8">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="90"/>
                                                                <ColumnDefinition Width="*"/>
                                                                <ColumnDefinition Width="30"/>
                                                            </Grid.ColumnDefinitions>
                                                            <TextBlock Text="Attack Vector" Foreground="{StaticResource TextSecondary}"
                                                                       FontFamily="Segoe UI" FontSize="11" VerticalAlignment="Center"/>
                                                            <Border Grid.Column="1" Height="6" Background="#091628" CornerRadius="3" VerticalAlignment="Center">
                                                                <Border x:Name="CvssAvBar" HorizontalAlignment="Left" Width="0"
                                                                        Height="6" CornerRadius="3" Background="{StaticResource CritBrush}"/>
                                                            </Border>
                                                            <TextBlock x:Name="CvssAvText" Grid.Column="2" Text="0"
                                                                       Foreground="{StaticResource TextSecondary}"
                                                                       FontFamily="Consolas" FontSize="11"
                                                                       HorizontalAlignment="Right" VerticalAlignment="Center"/>
                                                        </Grid>
                                                        <!-- Complexity -->
                                                        <Grid Margin="0,0,0,8">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="90"/>
                                                                <ColumnDefinition Width="*"/>
                                                                <ColumnDefinition Width="30"/>
                                                            </Grid.ColumnDefinitions>
                                                            <TextBlock Text="Complexity" Foreground="{StaticResource TextSecondary}"
                                                                       FontFamily="Segoe UI" FontSize="11" VerticalAlignment="Center"/>
                                                            <Border Grid.Column="1" Height="6" Background="#091628" CornerRadius="3" VerticalAlignment="Center">
                                                                <Border x:Name="CvssAcBar" HorizontalAlignment="Left" Width="0"
                                                                        Height="6" CornerRadius="3" Background="{StaticResource WarnBrush}"/>
                                                            </Border>
                                                            <TextBlock x:Name="CvssAcText" Grid.Column="2" Text="0"
                                                                       Foreground="{StaticResource TextSecondary}"
                                                                       FontFamily="Consolas" FontSize="11"
                                                                       HorizontalAlignment="Right" VerticalAlignment="Center"/>
                                                        </Grid>
                                                        <!-- Impact -->
                                                        <Grid Margin="0,0,0,8">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="90"/>
                                                                <ColumnDefinition Width="*"/>
                                                                <ColumnDefinition Width="30"/>
                                                            </Grid.ColumnDefinitions>
                                                            <TextBlock Text="Impact" Foreground="{StaticResource TextSecondary}"
                                                                       FontFamily="Segoe UI" FontSize="11" VerticalAlignment="Center"/>
                                                            <Border Grid.Column="1" Height="6" Background="#091628" CornerRadius="3" VerticalAlignment="Center">
                                                                <Border x:Name="CvssImpBar" HorizontalAlignment="Left" Width="0"
                                                                        Height="6" CornerRadius="3" Background="{StaticResource InfoBrush}"/>
                                                            </Border>
                                                            <TextBlock x:Name="CvssImpText" Grid.Column="2" Text="0"
                                                                       Foreground="{StaticResource TextSecondary}"
                                                                       FontFamily="Consolas" FontSize="11"
                                                                       HorizontalAlignment="Right" VerticalAlignment="Center"/>
                                                        </Grid>
                                                        <!-- Exploitability -->
                                                        <Grid>
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="90"/>
                                                                <ColumnDefinition Width="*"/>
                                                                <ColumnDefinition Width="30"/>
                                                            </Grid.ColumnDefinitions>
                                                            <TextBlock Text="Exploitability" Foreground="{StaticResource TextSecondary}"
                                                                       FontFamily="Segoe UI" FontSize="11" VerticalAlignment="Center"/>
                                                            <Border Grid.Column="1" Height="6" Background="#091628" CornerRadius="3" VerticalAlignment="Center">
                                                                <Border x:Name="CvssExpBar" HorizontalAlignment="Left" Width="0"
                                                                        Height="6" CornerRadius="3" Background="{StaticResource SafeBrush}"/>
                                                            </Border>
                                                            <TextBlock x:Name="CvssExpText" Grid.Column="2" Text="0"
                                                                       Foreground="{StaticResource TextSecondary}"
                                                                       FontFamily="Consolas" FontSize="11"
                                                                       HorizontalAlignment="Right" VerticalAlignment="Center"/>
                                                        </Grid>
                                                    </StackPanel>
                                                    <TextBlock Text="Bar width = relative severity on that vector. Each bar color matches the Color Key above."
                                                               Foreground="{StaticResource TextMuted}"
                                                               FontFamily="Segoe UI" FontSize="10"
                                                               TextWrapping="Wrap" Margin="0,4,0,0"/>
                                                </StackPanel>
                                            </Border>
                                        </Grid>

                                        <!-- Stat insight chips -->
                                        <Grid Margin="0,12,0,0">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>

                                            <Border Grid.Column="0" Background="{StaticResource BgBase}"
                                                    BorderBrush="{StaticResource BorderNormal}" BorderThickness="1"
                                                    CornerRadius="9" Padding="10,8" Margin="0,0,6,0">
                                                <StackPanel HorizontalAlignment="Center">
                                                    <TextBlock x:Name="StatAvgPktRate" Text="â€”"
                                                               Foreground="{StaticResource InfoBrush}"
                                                               FontFamily="Consolas" FontSize="18" FontWeight="Bold"
                                                               HorizontalAlignment="Center"/>
                                                    <TextBlock Text="avg pkt/s"
                                                               Foreground="{StaticResource TextMuted}"
                                                               FontFamily="Segoe UI" FontSize="10"
                                                               HorizontalAlignment="Center" Margin="0,3,0,0"/>
                                                </StackPanel>
                                            </Border>
                                            <Border Grid.Column="1" Background="{StaticResource BgBase}"
                                                    BorderBrush="{StaticResource BorderNormal}" BorderThickness="1"
                                                    CornerRadius="9" Padding="10,8" Margin="0,0,6,0">
                                                <StackPanel HorizontalAlignment="Center">
                                                    <TextBlock x:Name="StatUniqueIPs" Text="â€”"
                                                               Foreground="{StaticResource AccentBrush}"
                                                               FontFamily="Consolas" FontSize="18" FontWeight="Bold"
                                                               HorizontalAlignment="Center"/>
                                                    <TextBlock Text="unique IPs"
                                                               Foreground="{StaticResource TextMuted}"
                                                               FontFamily="Segoe UI" FontSize="10"
                                                               HorizontalAlignment="Center" Margin="0,3,0,0"/>
                                                </StackPanel>
                                            </Border>
                                            <Border Grid.Column="2" Background="{StaticResource BgBase}"
                                                    BorderBrush="{StaticResource BorderNormal}" BorderThickness="1"
                                                    CornerRadius="9" Padding="10,8" Margin="0,0,6,0">
                                                <StackPanel HorizontalAlignment="Center">
                                                    <TextBlock x:Name="StatArpAnomalies" Text="â€”"
                                                               Foreground="{StaticResource ArpBrush}"
                                                               FontFamily="Consolas" FontSize="18" FontWeight="Bold"
                                                               HorizontalAlignment="Center"/>
                                                    <TextBlock Text="ARP anomalies"
                                                               Foreground="{StaticResource TextMuted}"
                                                               FontFamily="Segoe UI" FontSize="10"
                                                               HorizontalAlignment="Center" Margin="0,3,0,0"/>
                                                </StackPanel>
                                            </Border>
                                            <Border Grid.Column="3" Background="{StaticResource BgBase}"
                                                    BorderBrush="{StaticResource BorderNormal}" BorderThickness="1"
                                                    CornerRadius="9" Padding="10,8" Margin="0,0,6,0">
                                                <StackPanel HorizontalAlignment="Center">
                                                    <TextBlock x:Name="StatDnsAnomalies" Text="â€”"
                                                               Foreground="{StaticResource DnsBrush}"
                                                               FontFamily="Consolas" FontSize="18" FontWeight="Bold"
                                                               HorizontalAlignment="Center"/>
                                                    <TextBlock Text="DNS anomalies"
                                                               Foreground="{StaticResource TextMuted}"
                                                               FontFamily="Segoe UI" FontSize="10"
                                                               HorizontalAlignment="Center" Margin="0,3,0,0"/>
                                                </StackPanel>
                                            </Border>
                                            <Border Grid.Column="4" Background="{StaticResource BgBase}"
                                                    BorderBrush="{StaticResource BorderNormal}" BorderThickness="1"
                                                    CornerRadius="9" Padding="10,8" Margin="0,0,6,0">
                                                <StackPanel HorizontalAlignment="Center">
                                                    <TextBlock x:Name="StatIpAnomalies" Text="â€”"
                                                               Foreground="{StaticResource IpBrush}"
                                                               FontFamily="Consolas" FontSize="18" FontWeight="Bold"
                                                               HorizontalAlignment="Center"/>
                                                    <TextBlock Text="IP anomalies"
                                                               Foreground="{StaticResource TextMuted}"
                                                               FontFamily="Segoe UI" FontSize="10"
                                                               HorizontalAlignment="Center" Margin="0,3,0,0"/>
                                                </StackPanel>
                                            </Border>
                                            <Border Grid.Column="5" Background="{StaticResource BgBase}"
                                                    BorderBrush="{StaticResource BorderNormal}" BorderThickness="1"
                                                    CornerRadius="9" Padding="10,8">
                                                <StackPanel HorizontalAlignment="Center">
                                                    <TextBlock x:Name="StatCaptureMins" Text="â€”"
                                                               Foreground="{StaticResource TextSecondary}"
                                                               FontFamily="Consolas" FontSize="18" FontWeight="Bold"
                                                               HorizontalAlignment="Center"/>
                                                    <TextBlock Text="capture mins"
                                                               Foreground="{StaticResource TextMuted}"
                                                               FontFamily="Segoe UI" FontSize="10"
                                                               HorizontalAlignment="Center" Margin="0,3,0,0"/>
                                                </StackPanel>
                                            </Border>
                                        </Grid>

                                        <Border Background="{StaticResource BgBase}"
                                                BorderBrush="{StaticResource BorderNormal}"
                                                BorderThickness="1"
                                                CornerRadius="8"
                                                Padding="10"
                                                Margin="0,10,0,0">
                                            <TextBlock x:Name="InsightsText"
                                                       Text="Run an analysis to populate insights."
                                                       Foreground="{StaticResource TextSecondary}"
                                                       FontFamily="Segoe UI"
                                                       FontSize="12"
                                                       TextWrapping="Wrap"/>
                                        </Border>
                                    </StackPanel>
                                </Border>

                                <Border Style="{StaticResource CardStyle}">
                                    <StackPanel>
                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,2">
                                            <TextBlock Text="ðŸ§­" FontSize="15" Margin="0,0,8,0" VerticalAlignment="Center"/>
                                            <TextBlock Text="CVSS v3 Rating Guide" Style="{StaticResource TitleStyle}" VerticalAlignment="Center"/>
                                        </StackPanel>
                                        <TextBlock Text="Reference ranges used for score interpretation in this dashboard and reports."
                                                   Style="{StaticResource SubTitleStyle}"/>
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>
                                            <Border Grid.Column="0" Background="#143A2A" CornerRadius="8" Padding="8" Margin="0,0,6,0"><TextBlock Text="Low: 0.1-3.9" Foreground="{StaticResource SafeBrush}" FontFamily="Segoe UI" FontSize="11"/></Border>
                                            <Border Grid.Column="1" Background="#3A2A14" CornerRadius="8" Padding="8" Margin="0,0,6,0"><TextBlock Text="Medium: 4.0-6.9" Foreground="{StaticResource WarnBrush}" FontFamily="Segoe UI" FontSize="11"/></Border>
                                            <Border Grid.Column="2" Background="#3A1F14" CornerRadius="8" Padding="8" Margin="0,0,6,0"><TextBlock Text="High: 7.0-8.9" Foreground="#FF7A59" FontFamily="Segoe UI" FontSize="11"/></Border>
                                            <Border Grid.Column="3" Background="#3A141A" CornerRadius="8" Padding="8"><TextBlock Text="Critical: 9.0-10.0" Foreground="{StaticResource CritBrush}" FontFamily="Segoe UI" FontSize="11"/></Border>
                                        </Grid>
                                    </StackPanel>
                                </Border>

                                <!-- MITRE ATT&CK -->
                                <Border Style="{StaticResource CardStyle}">
                                    <StackPanel>
                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,2">
                                            <TextBlock Text="ðŸŽ¯" FontSize="15" Margin="0,0,8,0" VerticalAlignment="Center"/>
                                            <TextBlock Text="MITRE ATT&amp;CK Mapping" Style="{StaticResource TitleStyle}" VerticalAlignment="Center"/>
                                        </StackPanel>
                                        <TextBlock Text="Known adversarial techniques corresponding to detected attack patterns."
                                                   Style="{StaticResource SubTitleStyle}"/>

                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>
                                            <!-- Column A -->
                                            <StackPanel Grid.Column="0" Margin="0,0,6,0">
                                                <Border Background="{StaticResource BgCardSoft}"
                                                        BorderBrush="{StaticResource InfoBrush}" BorderThickness="0,0,0,2"
                                                        CornerRadius="8" Padding="10" Margin="0,0,0,6">
                                                    <StackPanel>
                                                        <Border Background="#0E1E3A" CornerRadius="4" Padding="5,2" HorizontalAlignment="Left" Margin="0,0,0,4">
                                                            <TextBlock Text="T1557" Foreground="{StaticResource AccentBrush}"
                                                                       FontFamily="Consolas" FontSize="11" FontWeight="Bold"/>
                                                        </Border>
                                                        <TextBlock Text="Adversary-in-the-Middle"
                                                                   Foreground="{StaticResource TextPrimary}"
                                                                   FontFamily="Segoe UI" FontSize="12" FontWeight="SemiBold"/>
                                                        <TextBlock Text="Network interception via spoofed identity"
                                                                   Foreground="{StaticResource TextSecondary}"
                                                                   FontFamily="Segoe UI" FontSize="11"
                                                                   TextWrapping="Wrap" Margin="0,3,0,0"/>
                                                    </StackPanel>
                                                </Border>
                                                <Border Background="{StaticResource BgCardSoft}"
                                                        CornerRadius="8" Padding="10" Margin="0,0,0,6">
                                                    <StackPanel>
                                                        <Border Background="#160E2A" CornerRadius="4" Padding="5,2" HorizontalAlignment="Left" Margin="0,0,0,4">
                                                            <TextBlock Text="T1557.002" Foreground="{StaticResource ArpBrush}"
                                                                       FontFamily="Consolas" FontSize="11" FontWeight="Bold"/>
                                                        </Border>
                                                        <TextBlock Text="ARP Cache Poisoning"
                                                                   Foreground="{StaticResource ArpBrush}"
                                                                   FontFamily="Segoe UI" FontSize="12" FontWeight="SemiBold"/>
                                                        <TextBlock Text="Manipulate ARP tables to redirect L2 traffic"
                                                                   Foreground="{StaticResource TextSecondary}"
                                                                   FontFamily="Segoe UI" FontSize="11"
                                                                   TextWrapping="Wrap" Margin="0,3,0,0"/>
                                                    </StackPanel>
                                                </Border>
                                            </StackPanel>
                                            <!-- Column B -->
                                            <StackPanel Grid.Column="1">
                                                <Border Background="{StaticResource BgCardSoft}"
                                                        CornerRadius="8" Padding="10" Margin="0,0,0,6">
                                                    <StackPanel>
                                                        <Border Background="#071A28" CornerRadius="4" Padding="5,2" HorizontalAlignment="Left" Margin="0,0,0,4">
                                                            <TextBlock Text="T1071.004" Foreground="{StaticResource DnsBrush}"
                                                                       FontFamily="Consolas" FontSize="11" FontWeight="Bold"/>
                                                        </Border>
                                                        <TextBlock Text="DNS / Application Layer"
                                                                   Foreground="{StaticResource DnsBrush}"
                                                                   FontFamily="Segoe UI" FontSize="12" FontWeight="SemiBold"/>
                                                        <TextBlock Text="DNS abuse for C2 comms or data exfiltration"
                                                                   Foreground="{StaticResource TextSecondary}"
                                                                   FontFamily="Segoe UI" FontSize="11"
                                                                   TextWrapping="Wrap" Margin="0,3,0,0"/>
                                                    </StackPanel>
                                                </Border>
                                                <Border Background="{StaticResource BgCardSoft}"
                                                        CornerRadius="8" Padding="10" Margin="0,0,0,6">
                                                    <StackPanel>
                                                        <Border Background="#0A1428" CornerRadius="4" Padding="5,2" HorizontalAlignment="Left" Margin="0,0,0,4">
                                                            <TextBlock Text="T1036" Foreground="{StaticResource IpBrush}"
                                                                       FontFamily="Consolas" FontSize="11" FontWeight="Bold"/>
                                                        </Border>
                                                        <TextBlock Text="Masquerading"
                                                                   Foreground="{StaticResource IpBrush}"
                                                                   FontFamily="Segoe UI" FontSize="12" FontWeight="SemiBold"/>
                                                        <TextBlock Text="Attacker IP mimics trusted host identity"
                                                                   Foreground="{StaticResource TextSecondary}"
                                                                   FontFamily="Segoe UI" FontSize="11"
                                                                   TextWrapping="Wrap" Margin="0,3,0,0"/>
                                                    </StackPanel>
                                                </Border>
                                            </StackPanel>
                                        </Grid>
                                    </StackPanel>
                                </Border>

                            </StackPanel>

                            <!-- â”€â”€ RIGHT COLUMN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
                            <StackPanel Grid.Column="2">

                                <!-- Live Alerts -->
                                <Border Style="{StaticResource CardStyle}">
                                    <StackPanel>
                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,4">
                                            <TextBlock Text="ðŸ””" FontSize="14" Margin="0,0,6,0" VerticalAlignment="Center"/>
                                            <TextBlock Text="Live Alerts" Style="{StaticResource TitleStyle}" VerticalAlignment="Center"/>
                                        </StackPanel>
                                        <TextBlock x:Name="LiveAlertsLegendText"
                                                    FontFamily="Segoe UI" FontSize="11"
                                                    Foreground="{StaticResource TextSecondary}"
                                                    TextWrapping="Wrap" Margin="0,0,0,10" >
	                                        <Run Foreground="{StaticResource SafeBrush}" FontWeight="SemiBold">Green</Run>: &lt; 60% confidence (informational). <Run Foreground="{StaticResource WarnBrush}" FontWeight="SemiBold">Amber</Run>: 60%-84% (suspicious). <Run Foreground="{StaticResource CritBrush}" FontWeight="SemiBold">Red</Run>: â‰¥ 85% (critical)

                                        </TextBlock>
                                        <ScrollViewer Height="210" VerticalScrollBarVisibility="Auto">
                                            <StackPanel x:Name="AlertsPanel">
                                                <!-- Seed alert -->
                                                <Border Background="{StaticResource BgPanel}"
                                                        BorderBrush="#1A5030" BorderThickness="1"
                                                        CornerRadius="8" Padding="10,8" Margin="0,0,0,5">
                                                    <StackPanel>
                                                        <StackPanel Orientation="Horizontal">
                                                            <TextBlock Text="âœ“ " FontSize="12"/>
                                                            <TextBlock Text="System initialized. Awaiting capture."
                                                                       FontFamily="Segoe UI" FontSize="12"/>
                                                        </StackPanel>
                                                        <TextBlock Text="â€”"
                                                                   Foreground="{StaticResource TextMuted}"
                                                                   FontFamily="Consolas" FontSize="10"
                                                                   Margin="0,3,0,0"/>
                                                    </StackPanel>
                                                </Border>
                                            </StackPanel>
                                        </ScrollViewer>
                                    </StackPanel>
                                </Border>

                                <!-- Recent Cases -->
                                <Border Style="{StaticResource CardStyle}">
                                    <StackPanel>
                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,4">
                                            <TextBlock Text="ðŸ—‚" FontSize="14" Margin="0,0,6,0" VerticalAlignment="Center"/>
                                            <TextBlock Text="Summary Snapshot" Style="{StaticResource TitleStyle}" VerticalAlignment="Center"/>
                                        </StackPanel>
                                        <TextBlock Text="Quick overview of key results (displayed downward under Live Alerts)."
                                                   Style="{StaticResource SubTitleStyle}"/>
                                        <StackPanel>
                                            <Border Background="{StaticResource BgBase}" BorderBrush="{StaticResource BorderNormal}" BorderThickness="1" CornerRadius="8" Padding="10" Margin="0,0,0,6">
                                                <Grid><Grid.ColumnDefinitions><ColumnDefinition Width="*"/><ColumnDefinition Width="Auto"/></Grid.ColumnDefinitions>
                                                    <TextBlock Text="Overall Network Risk" Foreground="{StaticResource TextSecondary}" FontFamily="Segoe UI" FontSize="11"/>
                                                    <TextBlock Grid.Column="1" Text="{Binding Text, ElementName=NetworkStatusText}" Foreground="{StaticResource TextPrimary}" FontFamily="Consolas" FontSize="12" FontWeight="Bold"/>
                                                </Grid>
                                            </Border>
                                            <Border Background="{StaticResource BgBase}" BorderBrush="{StaticResource BorderNormal}" BorderThickness="1" CornerRadius="8" Padding="10" Margin="0,0,0,6">
                                                <Grid><Grid.ColumnDefinitions><ColumnDefinition Width="*"/><ColumnDefinition Width="Auto"/></Grid.ColumnDefinitions>
                                                    <TextBlock Text="CVSS v3 Score" Foreground="{StaticResource TextSecondary}" FontFamily="Segoe UI" FontSize="11"/>
                                                    <TextBlock Grid.Column="1" Text="{Binding Text, ElementName=CvssScoreText}" Foreground="{StaticResource TextPrimary}" FontFamily="Consolas" FontSize="12" FontWeight="Bold"/>
                                                </Grid>
                                            </Border>
                                            <Border Background="{StaticResource BgBase}" BorderBrush="{StaticResource BorderNormal}" BorderThickness="1" CornerRadius="8" Padding="10" Margin="0,0,0,6">
                                                <Grid><Grid.ColumnDefinitions><ColumnDefinition Width="*"/><ColumnDefinition Width="Auto"/></Grid.ColumnDefinitions>
                                                    <TextBlock Text="Packets Analyzed" Foreground="{StaticResource TextSecondary}" FontFamily="Segoe UI" FontSize="11"/>
                                                    <TextBlock Grid.Column="1" Text="{Binding Text, ElementName=PacketsAnalyzedText}" Foreground="{StaticResource TextPrimary}" FontFamily="Consolas" FontSize="12" FontWeight="Bold"/>
                                                </Grid>
                                            </Border>
                                            <Border Background="{StaticResource BgBase}" BorderBrush="{StaticResource BorderNormal}" BorderThickness="1" CornerRadius="8" Padding="10">
                                                <Grid><Grid.ColumnDefinitions><ColumnDefinition Width="*"/><ColumnDefinition Width="Auto"/></Grid.ColumnDefinitions>
                                                    <TextBlock Text="Critical Alerts" Foreground="{StaticResource TextSecondary}" FontFamily="Segoe UI" FontSize="11"/>
                                                    <TextBlock Grid.Column="1" Text="{Binding Text, ElementName=CriticalAlertsText}" Foreground="{StaticResource TextPrimary}" FontFamily="Consolas" FontSize="12" FontWeight="Bold"/>
                                                </Grid>
                                            </Border>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>

                                <Border Grid.Column="1" Style="{StaticResource CardStyle}" Margin="0,12,0,0">
                                    <StackPanel>
                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,4">
                                            <TextBlock Text="ðŸ—‚" FontSize="14" Margin="0,0,6,0" VerticalAlignment="Center"/>
                                            <TextBlock Text="Recent Cases" Style="{StaticResource TitleStyle}" VerticalAlignment="Center"/>
                                        </StackPanel>
                                        <TextBlock Text="Previous analysis sessions with computed CVSS score."
                   Style="{StaticResource SubTitleStyle}"/>
                                        <ListBox x:Name="RecentCasesList"
                 Background="Transparent"
                 BorderThickness="0"
                 Foreground="{StaticResource TextPrimary}"
                 Margin="0,0,0,0"
                 ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                                            <ListBox.ItemTemplate>
                                                <DataTemplate>
                                                    <TextBlock Text="{Binding}" Foreground="{StaticResource TextPrimary}" FontFamily="Consolas" FontSize="12" TextWrapping="Wrap" LineHeight="16"/>
                                                </DataTemplate>
                                            </ListBox.ItemTemplate>
                                            <ListBox.ItemContainerStyle>
                                                <Style TargetType="ListBoxItem">
                                                    <Setter Property="Background" Value="Transparent"/>
                                                    <Setter Property="BorderThickness" Value="0"/>
                                                    <Setter Property="Padding" Value="0"/>
                                                    <Setter Property="Margin" Value="0,0,0,5"/>
                                                    <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                                                    <Setter Property="Template">
                                                        <Setter.Value>
                                                            <ControlTemplate TargetType="ListBoxItem">
                                                                <Border x:Name="ItemBorder" Background="{StaticResource BgBase}" CornerRadius="8" Padding="10,8" BorderBrush="{StaticResource BorderNormal}" BorderThickness="1">
                                                                    <ContentPresenter/>
                                                                </Border>
                                                                <ControlTemplate.Triggers>
                                                                    <Trigger Property="IsMouseOver" Value="True">
                                                                        <Setter TargetName="ItemBorder" Property="BorderBrush" Value="{StaticResource BorderBright}"/>
                                                                    </Trigger>
                                                                    <Trigger Property="IsSelected" Value="True">
                                                                        <Setter TargetName="ItemBorder" Property="Background" Value="{StaticResource BgCardSoft}"/>
                                                                    </Trigger>
                                                                </ControlTemplate.Triggers>
                                                            </ControlTemplate>
                                                        </Setter.Value>
                                                    </Setter>
                                                </Style>
                                            </ListBox.ItemContainerStyle>
                                        </ListBox>
                                        <Button Content="â†»  Refresh"
                Click="RefreshRecentCasesBtn_Click"
                Background="#1A2C4A"
                Foreground="{StaticResource TextPrimary}"
                Style="{StaticResource GhostBtnStyle}"
                HorizontalAlignment="Stretch"
                Margin="0,6,0,0"/>
                                    </StackPanel>
                                </Border>

                            </StackPanel>
                        </Grid>

                        <!-- â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
                             ROW C â€” REPORTING & EVIDENCE
                             â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
                        <Grid Grid.Row="1">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" MinWidth="300"/>
                            </Grid.ColumnDefinitions>

                            <!-- Reporting & Evidence -->
                            <Border Grid.Column="0" Style="{StaticResource CardStyle}" Margin="0">
                                <StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,2">
                                        <TextBlock Text="ðŸ“„" FontSize="15" Margin="0,0,8,0" VerticalAlignment="Center"/>
                                        <TextBlock Text="Reporting &amp; Evidence" Style="{StaticResource TitleStyle}" VerticalAlignment="Center"/>
                                    </StackPanel>

                                    <Border Background="{StaticResource BgBase}"
                                            CornerRadius="8" Padding="10,7" Margin="0,4,0,12"
                                            BorderBrush="{StaticResource BorderNormal}" BorderThickness="1">
                                        <TextBlock x:Name="ReportModuleStatus"
                                                   Text="â¸  No analysis run yet. Run the pipeline to enable reports."
                                                   Foreground="{StaticResource TextSecondary}"
                                                   FontFamily="Consolas" FontSize="11"
                                                   TextWrapping="Wrap"/>
                                    </Border>

                                    <Grid Margin="0,0,0,8">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Button Grid.Column="0"
                                                Content="HTML Report"
                                                Click="GenerateHtmlReportBtn_Click"
                                                Background="{StaticResource InfoBrush}"
                                                Style="{StaticResource PrimaryBtnStyle}"
                                                Margin="0,0,5,0" HorizontalAlignment="Stretch"/>
                                        <Button Grid.Column="1"
                                                Content="JSON Export"
                                                Click="GenerateJsonReportBtn_Click"
                                                Background="#2563EB"
                                                Style="{StaticResource PrimaryBtnStyle}"
                                                Margin="0" HorizontalAlignment="Stretch"/>
                                    </Grid>
                                    <Grid Margin="0,0,0,8">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Button Grid.Column="0"
                                                Content="Preflight Check"
                                                Click="RunPreflightCheckBtn_Click"
                                                Background="#1A2C4A"
                                                Style="{StaticResource GhostBtnStyle}"
                                                Margin="0,0,5,0" HorizontalAlignment="Stretch"/>
                                        <Button Grid.Column="1"
                                                Content="Evidence Bundle"
                                                Click="ExportEvidenceBundleBtn_Click"
                                                Background="#1A2C4A"
                                                Style="{StaticResource GhostBtnStyle}"
                                                Margin="0" HorizontalAlignment="Stretch"/>
                                    </Grid>
                                    <Grid Margin="0,0,0,10">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Button Grid.Column="0"
                                                Content="ðŸ“ Reports Folder"
                                                Click="OpenReportsFolderBtn_Click"
                                                Background="#1A2C4A"
                                                Style="{StaticResource GhostBtnStyle}"
                                                Margin="0,0,5,0" HorizontalAlignment="Stretch"/>
                                        <Button Grid.Column="1"
                                                Content="ðŸ“ Logs Folder"
                                                Click="OpenLogsFolderBtn_Click"
                                                Background="#1A2C4A"
                                                Style="{StaticResource GhostBtnStyle}"
                                                Margin="0" HorizontalAlignment="Stretch"/>
                                    </Grid>

                                    <CheckBox x:Name="AutoRunCheckBox"
                                              Content="Auto-run analysis after valid upload (disabled; run manually)"
                                              IsEnabled="False"
                                              Checked="AutoRunCheckBox_Changed"
                                              Unchecked="AutoRunCheckBox_Changed"
                                              Style="{StaticResource ToggleStyle}"/>
                                </StackPanel>
                            </Border>

                            
                        </Grid>

                    </Grid>
                </ScrollViewer>

                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                     LOADING OVERLAY
                     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                <Border x:Name="LoadingOverlay"
                        Background="#C007111E"
                        Visibility="Collapsed">
                    <Grid>
                        <Border Background="#0E1E33"
                                CornerRadius="16" Padding="28"
                                Width="420"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                BorderThickness="1"
                                BorderBrush="{StaticResource InfoBrush}">
                            <StackPanel>
                                <TextBlock Text="Processing Analysisâ€¦"
                                           Foreground="{StaticResource TextPrimary}"
                                           FontFamily="Segoe UI" FontSize="18" FontWeight="SemiBold"
                                           HorizontalAlignment="Center" Margin="0,0,0,16"/>
                                <ProgressBar IsIndeterminate="True"
                                             Height="8"
                                             Margin="0,0,0,12"/>
                                <TextBlock x:Name="LoadingProgressText"
                                           Text="Initializing pipelineâ€¦"
                                           Foreground="{StaticResource TextSecondary}"
                                           FontFamily="Consolas" FontSize="12"
                                           TextAlignment="Center"/>
                            </StackPanel>
                        </Border>
                    </Grid>
                </Border>

                <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                     HIDDEN COMPATIBILITY STUBS
                     Visibility="Collapsed" â€” zero visual impact.
                     Provide x:Name bindings that existing
                     code-behind (MainWindow.xaml.cs) references,
                     preventing CS0103 compile errors.
                     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
                <!-- Compatibility stubs: Width/Height=0, zero visual impact -->
                <Grid Visibility="Collapsed" Width="0" Height="0">
                    <TextBlock x:Name="NetworkStatusIcon" Text="" FontSize="1"/>
                    <Ellipse x:Name="StatusIndicator" Width="1" Height="1"/>
                    <ItemsControl x:Name="MitreBulletsCompat">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding}" FontSize="1"/>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </Grid>

            </Grid>
        </Grid>
    </Border>
</Window>
